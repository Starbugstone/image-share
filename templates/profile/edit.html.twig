{% extends 'base.html.twig' %}

{% block title %}Edit Profile{% endblock %}

{% block body %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-8 mx-auto">
            <div class="card">
                <div class="card-header">
                    <h2 class="mb-0">
                        <i class="fas fa-user-edit me-2"></i>Edit Profile
                    </h2>
                </div>
                <div class="card-body">
                    <!-- Current Profile Image -->
                    <div class="text-center mb-4">
                        <div class="profile-image-container">
                            {% if profile.profileImageName %}
                                <img src="{{ asset('uploads/profile_images/' ~ profile.profileImageName) }}" 
                                     alt="Profile Image" 
                                     class="profile-image rounded-circle">
                            {% else %}
                                <div class="profile-image-placeholder rounded-circle">
                                    <i class="fas fa-user fa-3x text-muted"></i>
                                </div>
                            {% endif %}
                        </div>
                        <p class="text-muted mt-2">Current profile image</p>
                    </div>

                    {{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': 'novalidate'}}) }}
                    
                    <div class="row">
                        <div class="col-md-6">
                            {{ form_row(form.displayName, {
                                'attr': {
                                    'class': 'form-control',
                                    'placeholder': 'Enter your display name'
                                }
                            }) }}
                        </div>
                        <div class="col-md-6">
                            {{ form_row(form.location, {
                                'attr': {
                                    'class': 'form-control',
                                    'placeholder': 'City, Country'
                                }
                            }) }}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            {{ form_row(form.website, {
                                'attr': {
                                    'class': 'form-control',
                                    'placeholder': 'https://example.com'
                                }
                            }) }}
                        </div>
                        <div class="col-md-6">
                            {{ form_row(form.status, {
                                'attr': {
                                    'class': 'form-select'
                                }
                            }) }}
                        </div>
                    </div>

                    {{ form_row(form.bio, {
                        'attr': {
                            'class': 'form-control',
                            'rows': 4,
                            'placeholder': 'Tell us about yourself...'
                        }
                    }) }}

                    <div class="row">
                        <div class="col-md-6">
                            {{ form_row(form.profileImage, {
                                'attr': {
                                    'class': 'form-control',
                                    'accept': 'image/*'
                                }
                            }) }}
                            <small class="form-text text-muted">
                                Supported formats: JPEG, PNG, GIF, WebP. Max size: 2MB.
                            </small>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check mt-4">
                                {{ form_widget(form.isPublic, {
                                    'attr': {
                                        'class': 'form-check-input'
                                    }
                                }) }}
                                {{ form_label(form.isPublic, null, {
                                    'label_attr': {
                                        'class': 'form-check-label'
                                    }
                                }) }}
                                <small class="form-text text-muted d-block">
                                    Public profiles are visible to all users
                                </small>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="{{ path('app_profile_me') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-2"></i>Save Changes
                        </button>
                    </div>

                    {{ form_end(form) }}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.profile-image-container {
    position: relative;
    display: inline-block;
}

.profile-image, .profile-image-placeholder {
    width: 120px;
    height: 120px;
    object-fit: cover;
    border: 3px solid #fff;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.profile-image-placeholder {
    background-color: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6c757d;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.form-control:focus, .form-select:focus {
    border-color: #007bff;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

.btn {
    padding: 0.5rem 1.5rem;
    font-weight: 500;
}

.btn-primary {
    background-color: #007bff;
    border-color: #007bff;
}

.btn-primary:hover {
    background-color: #0056b3;
    border-color: #0056b3;
}
</style>
{% endblock %}
